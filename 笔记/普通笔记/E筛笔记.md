##### luogu1621集合[我的代码](/home/majiao/桌面/Link to 刷题/hdu/第一阶段/素数筛/luogu1621埃筛+并查集/)

> 现在给你一些连续的整数，它们是从A到B的整数。一开始每个整数都属于各自的集合，然后你需要进行一下的操作:
>
> 每次选择两个属于不同集合的整数，如果这两个整数拥有大于等于P的公共质因数，那么把它们所在的集合合并。
>
> 反复如上操作，直到没有可以合并的集合为止。
>
> 现在Caima想知道，最后有多少个集合。

* 并查集 + 埃筛

* 用一个质数可以筛掉很多个合数(设$n$个),把这$n$个合数$union_xy(x,y)$, 最后统计$-1$的个数即可

  ```c++
  for(int i=2; i<=B; i++) { //埃筛
  		if(vis[i]) continue ;
  		if(i >= K) { //质因子大于K才合并
  			for(int k=(i<<1); k<=B; k+=i)  {
  				vis[k] = true;
  				if(k-i >= A/*大于A? 为啥不是K*/) 
                    union_xy(k, k-i);
  			}
  		} else {
  			for(int k=(i<<1); k<=B; k+=i)
  				vis[k] = true;
  		}
  	}
  ```

  ​